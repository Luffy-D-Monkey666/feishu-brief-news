{% extends "base.html" %}

{% block title %}ç§‘æŠ€ç®€æŠ¥ Â· æ¯æ—¥å…¨çƒç§‘æŠ€æ´å¯Ÿ{% endblock %}

{% block content %}
<div class="min-h-screen">
    <!-- Header -->
    <header class="nav-blur sticky top-0 z-40 border-b border-zinc-800 safe-top">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="text-xl">ğŸ“°</span>
                <span class="font-semibold">ç§‘æŠ€ç®€æŠ¥</span>
            </div>
            <div class="flex items-center gap-4">
                <p class="text-xs text-zinc-500 hidden sm:block">AIé©±åŠ¨ Â· 66+ å…¨çƒç§‘æŠ€æº Â· æ¯æ—¥æ›´æ–°</p>
                <a href="/search" class="flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-zinc-800/50 hover:bg-zinc-700/50 text-zinc-400 hover:text-zinc-200 transition-colors text-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                    <span class="hidden sm:inline">æœç´¢</span>
                </a>
            </div>
        </div>
    </header>
    
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% if latest_briefing %}
        
        <!-- Hero Stats Section -->
        <section class="mb-8 animate-in">
            <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-6">
                <div>
                    <p class="text-sm text-zinc-500 mb-1">{{ latest_date[:4] }}å¹´{{ latest_date[4:6] }}æœˆ{{ latest_date[6:] }}æ—¥ ç®€æŠ¥</p>
                    <h1 class="text-2xl sm:text-3xl font-bold">
                        <span class="gradient-text">ä»Šæ—¥ç§‘æŠ€è¦é—»</span>
                    </h1>
                </div>
                <a href="/briefing/{{ latest_date }}" class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded-lg transition-colors">
                    é˜…è¯»å®Œæ•´ç®€æŠ¥
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </a>
            </div>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                <div class="card p-4">
                    <p class="text-3xl font-bold text-blue-400">{{ latest_briefing.total_articles or 0 }}</p>
                    <p class="text-sm text-zinc-500 mt-1">æ–°é—»æ€»æ•°</p>
                </div>
                <div class="card p-4">
                    <p class="text-3xl font-bold text-purple-400">{{ latest_briefing.categories_count or 0 }}</p>
                    <p class="text-sm text-zinc-500 mt-1">è¦†ç›–ç±»åˆ«</p>
                </div>
                <div class="card p-4">
                    <p class="text-3xl font-bold text-pink-400">{{ latest_briefing.sources_count or 0 }}</p>
                    <p class="text-sm text-zinc-500 mt-1">ä¿¡æ¯æ¥æº</p>
                </div>
                <div class="card p-4">
                    <p class="text-3xl font-bold text-emerald-400">{{ latest_briefing.predictions|length if latest_briefing.predictions else 0 }}</p>
                    <p class="text-sm text-zinc-500 mt-1">è¶‹åŠ¿é¢„æµ‹</p>
                </div>
            </div>
        </section>
        
        <!-- Summary -->
        {% if latest_briefing.summary %}
        <section class="mb-8 animate-in" style="animation-delay: 0.05s;">
            <div class="summary-box">
                <div class="flex items-start gap-3">
                    <span class="text-2xl">ğŸ“Œ</span>
                    <div>
                        <h2 class="font-semibold text-lg mb-2">ä»Šæ—¥æ¦‚è§ˆ</h2>
                        <p class="text-zinc-300 leading-relaxed">{{ latest_briefing.summary }}</p>
                    </div>
                </div>
            </div>
        </section>
        {% endif %}
        
        <!-- Main Grid: Headlines + Categories -->
        <div class="grid lg:grid-cols-3 gap-8">
            
            <!-- Headlines (Left 2 cols) -->
            <section class="lg:col-span-2 animate-in" style="animation-delay: 0.1s;">
                <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                    <span>ğŸ”¥</span> çƒ­ç‚¹æ–°é—»
                </h2>
                <div class="space-y-4">
                    {% for article in hot_articles %}
                    <a href="/briefing/{{ latest_date }}#article-{{ article.id }}" class="card p-4 block hover:border-zinc-600 group">
                        <div class="flex items-start gap-3">
                            <span class="category-badge cat-{{ article.category }}" style="background: var(--cat-bg); color: var(--cat-color); flex-shrink: 0; font-size: 11px; padding: 2px 8px;">
                                {% if article.category == 'ai' %}ğŸ¤– AI{% elif article.category == 'robotics' %}ğŸ¦¾ æœºå™¨äºº{% elif article.category == 'embodied_ai' %}ğŸ‘“ å…·èº«æ™ºèƒ½{% elif article.category == 'semiconductor' %}ğŸ’¾ åŠå¯¼ä½“{% elif article.category == 'auto' %}ğŸš— æ±½è½¦{% elif article.category == 'health' %}ğŸ¥ åŒ»ç–—{% elif article.category == 'economy' %}ğŸ“Š ç»æµ{% elif article.category == 'business' %}ğŸ’¼ å•†ä¸š{% elif article.category == 'politics' %}ğŸ›ï¸ æ”¿æ²»{% elif article.category == 'investment' %}ğŸ“ˆ æŠ•èµ„{% elif article.category == 'consumer_electronics' %}ğŸ“± æ¶ˆè´¹ç”µå­{% elif article.category == 'key_people' %}ğŸ¤ äººç‰©{% else %}ğŸ“Œ {{ article.category }}{% endif %}
                            </span>
                            <div class="flex-1 min-w-0">
                                <h3 class="font-medium text-zinc-100 group-hover:text-blue-400 transition-colors line-clamp-2">
                                    {{ article.title_zh }}
                                </h3>
                                <div class="flex items-center gap-3 mt-2 text-xs text-zinc-500">
                                    <span>{{ article.source }}</span>
                                    <span>{{ article.published_at }}</span>
                                </div>
                            </div>
                            <svg class="w-4 h-4 text-zinc-600 group-hover:text-zinc-400 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </div>
                    </a>
                    {% endfor %}
                    
                    {% if latest_briefing.total_articles and latest_briefing.total_articles > 8 %}
                    <a href="/briefing/{{ latest_date }}" class="block text-center py-3 text-sm text-blue-400 hover:text-blue-300">
                        æŸ¥çœ‹å…¨éƒ¨ {{ latest_briefing.total_articles }} æ¡æ–°é—» â†’
                    </a>
                    {% endif %}
                </div>
            </section>
            
            <!-- Right Sidebar: Categories + History -->
            <aside class="space-y-6 animate-in" style="animation-delay: 0.15s;">
                
                <!-- Categories Dashboard -->
                <div class="card p-4">
                    <h2 class="text-sm font-semibold text-zinc-400 mb-3 uppercase tracking-wider">åˆ†ç±»ç»Ÿè®¡</h2>
                    <div class="space-y-2">
                        {% set category_icons = {
                            'ai': 'ğŸ¤– AI',
                            'robotics': 'ğŸ¦¾ æœºå™¨äºº',
                            'embodied_ai': 'ğŸ‘“ å…·èº«æ™ºèƒ½',
                            'semiconductor': 'ğŸ’¾ åŠå¯¼ä½“',
                            'auto': 'ğŸš— æ±½è½¦',
                            'health': 'ğŸ¥ åŒ»ç–—',
                            'economy': 'ğŸ“Š ç»æµ',
                            'business': 'ğŸ’¼ å•†ä¸š',
                            'politics': 'ğŸ›ï¸ æ”¿æ²»',
                            'investment': 'ğŸ“ˆ æŠ•èµ„',
                            'consumer_electronics': 'ğŸ“± æ¶ˆè´¹ç”µå­',
                            'key_people': 'ğŸ¤ å…³é”®äººç‰©'
                        } %}
                        {% for category, articles in latest_briefing.articles_by_category.items() if articles %}
                        <a href="/briefing/{{ latest_date }}#category-{{ category }}" class="flex items-center justify-between py-2 px-3 rounded-lg hover:bg-zinc-800/50 transition-colors group">
                            <span class="text-sm cat-{{ category }}" style="color: var(--cat-color);">
                                {{ category_icons.get(category, 'ğŸ“Œ ' + category) }}
                            </span>
                            <span class="text-sm font-medium text-zinc-400 group-hover:text-zinc-200">{{ articles|length }}</span>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Predictions Preview -->
                {% if latest_briefing.predictions %}
                <div class="card p-4">
                    <h2 class="text-sm font-semibold text-zinc-400 mb-3 uppercase tracking-wider">ğŸ”® è¶‹åŠ¿é¢„æµ‹</h2>
                    <div class="space-y-3">
                        {% for pred in latest_briefing.predictions[:4] %}
                        <div class="text-sm">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs px-2 py-0.5 rounded bg-zinc-800 text-zinc-400">{{ pred.timeframe }}</span>
                                <span class="text-zinc-500">{{ pred.category_name }}</span>
                            </div>
                            <p class="text-zinc-300 line-clamp-2">{{ pred.content[:80] }}{% if pred.content|length > 80 %}...{% endif %}</p>
                        </div>
                        {% endfor %}
                    </div>
                    <a href="/briefing/{{ latest_date }}#predictions" class="block mt-4 text-xs text-blue-400 hover:text-blue-300">
                        æŸ¥çœ‹å…¨éƒ¨é¢„æµ‹ â†’
                    </a>
                </div>
                {% endif %}
                
                <!-- Recent Briefings -->
                {% if dates|length > 1 %}
                <div class="card p-4">
                    <h2 class="text-sm font-semibold text-zinc-400 mb-3 uppercase tracking-wider">ğŸ“… å†å²ç®€æŠ¥</h2>
                    <div class="space-y-1">
                        {% for date in dates[1:8] %}
                        <a href="/briefing/{{ date }}" class="flex items-center justify-between py-2 px-3 rounded-lg hover:bg-zinc-800/50 transition-colors text-sm">
                            <span class="text-zinc-300">{{ date[4:6] }}æœˆ{{ date[6:] }}æ—¥</span>
                            <span class="text-zinc-600">{{ date[:4] }}</span>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                
            </aside>
        </div>
        
        {% else %}
        <!-- Empty State -->
        <section class="text-center py-20 animate-in">
            <div class="text-5xl mb-4">ğŸ“­</div>
            <p class="text-zinc-400 mb-2">æš‚æ— ç®€æŠ¥æ•°æ®</p>
            <p class="text-sm text-zinc-600">ç®€æŠ¥å°†åœ¨æ¯å¤©æ—©ä¸Š 06:00 è‡ªåŠ¨ç”Ÿæˆ</p>
        </section>
        {% endif %}
    </main>
    
    <!-- Footer -->
    <footer class="border-t border-zinc-800 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <p class="text-xs text-zinc-600 text-center">
                AIé©±åŠ¨çš„å…¨çƒç§‘æŠ€ç®€æŠ¥ Â· æ¯æ—¥ 06:00 CST è‡ªåŠ¨æ›´æ–° Â· æ•°æ®æ¥æºäº 66+ å…¨çƒç§‘æŠ€åª’ä½“
            </p>
        </div>
    </footer>
</div>

<style>
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{% endblock %}
