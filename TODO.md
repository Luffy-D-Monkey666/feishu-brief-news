# TODO - 科技简报优化清单

> 整理于 2026-02-21，按优先级排序

---

## P0 - 必须立即修复

### 1. 影响分析凑数 + 排版混乱
**文件**: `src/processor.py`

**现状问题**:
- 强行拆成 3 点，很多是一个意思反复说
- 排版混乱：第 3 点前面莫名插入一句话断开

**解决方案**:
- 修改 prompt，要求生成 1-2 条精炼洞察，不强求数量
- 去掉"1. 2. 3."序号格式，用自然段落
- 输出格式改为：一段话总结核心影响，不超过 100 字

**涉及代码**:
```python
# processor.py 中的 translate_summarize_and_classify 方法
# 修改 system_prompt 中关于 impact_analysis 的要求
```

---

### 2. 预测与当天新闻脱节
**文件**: `src/predictor.py`

**现状问题**:
- 生成的是泛泛的"领域预测"，跟当天具体新闻关联弱
- prompt 是"对该领域的未来发展做出专业预测"

**解决方案**:
- 改 prompt 为："基于以上具体新闻事件，推演接下来可能的后续发展"
- 要求明确引用当天的具体事件
- 预测内容格式改为："因为 [具体新闻]，所以预计 [后续发展]"

**涉及代码**:
```python
# predictor.py 中的 generate_predictions 方法
# 重写 system_prompt 和 prompt
```

---

### 3. 重复新闻未有效去重
**文件**: `src/processor.py`

**现状问题**:
- Phil Spencer 离职新闻出现 4 次（来自不同源）
- 当前去重基于简单的词袋模型+余弦相似度，阈值 0.85 太高

**解决方案**:
- 降低去重阈值到 0.7
- 增加标题关键实体提取（人名、公司名、事件类型）
- 同一事件的多篇报道合并为一条，显示"综合 N 个来源"

**涉及代码**:
```python
# processor.py 中的 deduplicate 方法
# 增强相似度计算逻辑
```

---

## P1 - 重要改进

### 4. 摘要过长/废话多
**文件**: `src/processor.py`

**现状问题**:
- 每篇摘要 3-5 段，阅读负担重
- 抓取失败时显示大段废话："尽管正文因访问限制未能获取…"

**解决方案**:
- 修改 prompt，要求摘要不超过 150 字
- 抓取失败时只保留标题和来源，不生成填充性摘要
- 增加字数检查，超长自动截断

---

### 5. 低质量内容混入
**文件**: `src/processor.py`, `config/sources.yaml`

**现状问题**:
- 游戏攻略（NYT Strands）、促销导购文章混入正经新闻
- Reddit 帖子质量参差不齐

**解决方案**:
- 增加内容过滤规则（标题关键词黑名单：hints, answers, deal, sale, lowest price）
- 给不同来源分级（tier1/tier2/tier3），低级来源更严格过滤
- 分类时增加 "skip" 选项，明确排除非科技行业新闻

---

### 6. 抓取失败率高
**文件**: `src/collector.py`

**现状问题**:
- 多篇新闻显示 429 错误
- 部分网站反爬严格

**解决方案**:
- 增加请求间隔（随机 2-5 秒）
- 增加重试逻辑（429 时等待后重试）
- 抓取失败的文章标记为 incomplete，后续处理时跳过或简化

---

## P2 - 体验优化

### 7. 首页热点新闻排序不合理
**文件**: `web/templates/index.html`, `web/app.py`

**现状问题**:
- 按分类顺序排列，不是按重要性/时效性

**解决方案**:
- 增加文章权重评分：来源权威性 + 提及关键人物 + 分类热度
- 首页热点按权重排序，优先展示高分文章

---

### 8. 搜索功能缺失
**文件**: `web/app.py`, `web/templates/`

**现状问题**:
- 无法快速找到特定话题

**解决方案**:
- 增加简单的关键词搜索（标题 + 摘要全文匹配）
- 首页增加搜索框
- API 增加 `/api/search?q=xxx`

---

### 9. 跨日期话题追踪缺失
**文件**: `web/app.py`, `src/processor.py`

**现状问题**:
- 看不到某个话题的连续演变

**解决方案**:
- 处理时提取文章的核心实体（公司、人物、事件）
- 增加"相关报道"功能，链接到其他日期的同话题文章
- 首页可选"按话题浏览"视图

---

## P3 - 细节打磨

### 10. 移动端目录按钮位置不佳
**文件**: `web/templates/briefing.html`

**现状问题**:
- 右下角浮动按钮容易被误触，遮挡内容

**解决方案**:
- 改为左下角，或顶部汉堡菜单
- 增加按钮的点击区域但缩小视觉大小

---

### 11. 分类内预测位置不明显
**文件**: `web/templates/briefing.html`

**现状问题**:
- 预测放在所有文章之后，容易被忽略

**解决方案**:
- 考虑放在分类标题下方作为折叠卡片
- 或在分类开头增加"本领域预测"摘要

---

### 12. "阅读原文"按钮不够醒目
**文件**: `web/templates/briefing.html`

**现状问题**:
- 颜色偏暗，容易忽略

**解决方案**:
- 加强对比度
- 改为更明显的 CTA 样式（实心按钮）

---

## 进度追踪

| # | 任务 | 状态 | 完成日期 |
|---|------|------|----------|
| 1 | 影响分析优化 | ✅ DONE | 2026-02-21 |
| 2 | 预测关联新闻 | ✅ DONE | 2026-02-21 |
| 3 | 去重优化 | ⬜ TODO | - |
| 4 | 摘要精简 | ⬜ TODO | - |
| 5 | 内容过滤 | ⬜ TODO | - |
| 6 | 抓取稳定性 | ⬜ TODO | - |
| 7 | 热点排序 | ⬜ TODO | - |
| 8 | 搜索功能 | ⬜ TODO | - |
| 9 | 话题追踪 | ⬜ TODO | - |
| 10 | 移动端按钮 | ⬜ TODO | - |
| 11 | 预测位置 | ⬜ TODO | - |
| 12 | 原文按钮 | ⬜ TODO | - |

---

*建议从 P0 开始，逐个完成后打勾*
